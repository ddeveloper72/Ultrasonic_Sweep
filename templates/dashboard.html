<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UAP Signal Generator Dashboard</title>
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/dashboard.css') }}" rel="stylesheet">
</head>

<body>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">
                <i class="bi bi-broadcast"></i> UAP Signal Generator
            </span>
            <div>
                <a href="/" class="btn btn-sm btn-outline-light me-2"><i class="bi bi-sliders"></i> Generator</a>
                <a href="/documentation" class="btn btn-sm btn-outline-light"><i class="bi bi-book"></i>
                    Documentation</a>
            </div>
            <span class="badge bg-success">v2.0 - Hybrid Multi-Layer</span>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <div class="row">
            <!-- Left Panel: Presets and Configuration -->
            <div class="col-md-4">
                <div class="card mb-3">
                    <div class="card-header bg-primary text-white">
                        <i class="bi bi-collection"></i> Signal Presets
                    </div>
                    <div class="card-body">
                        <select id="presetSelector" class="form-select mb-3">
                            <option value="">Select a preset...</option>
                            {% for key, preset in presets.items() %}
                            <option value="{{ key }}">{{ preset.name }}</option>
                            {% endfor %}
                        </select>
                        <div id="presetDescription" class="alert alert-info d-none"></div>
                    </div>
                </div>

                <div class="card mb-3">
                    <div class="card-header bg-success text-white">
                        <i class="bi bi-music-note-beamed"></i> Music Integration
                    </div>
                    <div class="card-body">
                        <div class="form-check form-switch mb-3">
                            <input class="form-check-input" type="checkbox" id="useMusicSwitch">
                            <label class="form-check-label" for="useMusicSwitch">
                                Use Music Modulation
                            </label>
                        </div>

                        <div id="musicSection" class="d-none">
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" id="musicFoundationSwitch">
                                <label class="form-check-label" for="musicFoundationSwitch">
                                    Use Music as Foundation Layer
                                </label>
                                <div class="text-muted small mt-1">
                                    Music becomes the base layer instead of synthetic tones
                                </div>
                            </div>

                            <label class="form-label">Select Music File:</label>
                            <select id="musicFileSelector" class="form-select mb-2">
                                <option value="">No music files available</option>
                            </select>

                            <div class="mb-3">
                                <label for="youtubeUrl" class="form-label">YouTube URL:</label>
                                <input type="text" class="form-control" id="youtubeUrl"
                                    placeholder="https://www.youtube.com/watch?v=...">
                                <div class="text-warning small mt-1" id="youtubeWarning">
                                    <i class="bi bi-exclamation-triangle"></i>
                                    <strong>Note:</strong> YouTube downloads work reliably on local installations only.
                                    On hosted versions, please use the file upload option instead.
                                </div>
                            </div>

                            <button class="btn btn-sm btn-outline-primary" id="downloadYoutubeBtn">
                                <i class="bi bi-download"></i> Download from YouTube
                            </button>

                            <div class="mt-2">
                                <small class="text-muted">Or upload a local file:</small>
                                <input type="file" class="form-control mt-1" id="musicUpload"
                                    accept=".mp3,.mp4,.wav,.flac,.m4a">
                                <button class="btn btn-sm btn-outline-secondary mt-1" id="uploadMusicBtn">
                                    <i class="bi bi-upload"></i> Upload File
                                </button>
                                <div class="text-info small mt-1" id="uploadWarning">
                                    <i class="bi bi-info-circle"></i>
                                    <strong>File size limit:</strong> Maximum 10MB. Files are stored in memory and will
                                    be cleared on server restart.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card mb-3">
                    <div class="card-header bg-warning text-dark">
                        <i class="bi bi-sliders"></i> Frequency Configuration
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Base Tone (Hz):</label>
                            <input type="number" class="form-control freq-input" id="baseToneFreq" value="100" min="10"
                                max="1000">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Schumann Resonance (Hz):</label>
                            <input type="number" class="form-control freq-input" id="schumannFreq" value="7.83"
                                step="0.01" min="1" max="50">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">DNA Repair Tone (Hz):</label>
                            <input type="number" class="form-control freq-input" id="dnaRepairFreq" value="528"
                                min="100" max="1000">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Ambient Pad (Hz):</label>
                            <input type="number" class="form-control freq-input" id="ambientFreq" value="432" min="100"
                                max="1000">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Chirp Frequency (Hz):</label>
                            <input type="number" class="form-control freq-input" id="chirpFreq" value="2500" min="1000"
                                max="5000">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Ultrasonic Ping (Hz):</label>
                            <input type="number" class="form-control freq-input" id="ultrasonicFreq" value="17000"
                                min="15000" max="20000">
                        </div>
                    </div>
                </div>

                <div class="card mb-3">
                    <div class="card-header bg-info text-white">
                        <i class="bi bi-soundwave"></i> Modulation Settings
                    </div>
                    <div class="card-body">
                        <div class="form-check form-switch mb-3">
                            <input class="form-check-input" type="checkbox" id="tremoloSwitch" checked>
                            <label class="form-check-label" for="tremoloSwitch">
                                Enable Tremolo (Earth Heartbeat)
                            </label>
                        </div>

                        <div id="tremoloSettings">
                            <label class="form-label">Tremolo Depth:</label>
                            <input type="range" class="form-range" id="tremoloDepth" min="0" max="100" value="50">
                            <div class="text-muted small">Depth: <span id="tremoloDepthValue">50</span>%</div>
                        </div>
                    </div>
                </div>

                <div class="d-grid gap-2">
                    <button class="btn btn-lg btn-primary" id="generateBtn">
                        <i class="bi bi-play-circle"></i> Generate Signal
                    </button>
                </div>
            </div>

            <!-- Right Panel: Visualization and Output -->
            <div class="col-md-8">
                <div class="card mb-3">
                    <div class="card-header bg-dark text-white">
                        <i class="bi bi-graph-up"></i> Signal Visualization
                    </div>
                    <div class="card-body">
                        <!-- Nav tabs -->
                        <ul class="nav nav-tabs mb-3" id="visualizationTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="waveform-tab" data-bs-toggle="tab"
                                    data-bs-target="#waveform-pane" type="button" role="tab">
                                    Waveform
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="spectrum-tab" data-bs-toggle="tab"
                                    data-bs-target="#spectrum-pane" type="button" role="tab">
                                    FFT Spectrum
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="spectrogram-tab" data-bs-toggle="tab"
                                    data-bs-target="#spectrogram-pane" type="button" role="tab">
                                    Spectrogram
                                </button>
                            </li>
                        </ul>

                        <!-- Tab content -->
                        <div class="tab-content" id="visualizationTabContent">
                            <div class="tab-pane fade show active" id="waveform-pane" role="tabpanel">
                                <canvas id="waveformCanvas" width="800" height="300"></canvas>
                            </div>
                            <div class="tab-pane fade" id="spectrum-pane" role="tabpanel">
                                <canvas id="spectrumCanvas" width="800" height="300"></canvas>
                            </div>
                            <div class="tab-pane fade" id="spectrogram-pane" role="tabpanel">
                                <canvas id="spectrogramCanvas" width="800" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card mb-3">
                    <div class="card-header bg-success text-white">
                        <i class="bi bi-music-note-beamed"></i> Playback & Download
                    </div>
                    <div class="card-body">
                        <div id="downloadSection" class="d-none">
                            <audio id="audioPlayer" class="w-100 mb-3" controls></audio>

                            <div class="btn-group w-100 mb-3" role="group">
                                <button class="btn btn-primary" id="playBtn">
                                    <i class="bi bi-play-fill"></i> Play
                                </button>
                                <button class="btn btn-warning" id="pauseBtn" disabled>
                                    <i class="bi bi-pause-fill"></i> Pause
                                </button>
                                <button class="btn btn-danger" id="stopBtn" disabled>
                                    <i class="bi bi-stop-fill"></i> Stop
                                </button>
                            </div>

                            <button class="btn btn-success w-100" id="downloadBtn">
                                <i class="bi bi-download"></i> Download Signal
                            </button>
                            <div id="downloadFilename" class="mt-2 text-muted"></div>
                        </div>
                        <div id="noSignal">
                            <p class="text-muted">No signals generated yet.</p>
                        </div>
                    </div>
                </div>

                <div class="card mb-3">
                    <div class="card-header bg-secondary text-white">
                        <i class="bi bi-info-circle"></i> Signal Information
                    </div>
                    <div class="card-body">
                        <div id="signalInfo">
                            <p class="text-muted">Generate a signal to see details...</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header bg-warning text-dark">
                        <i class="bi bi-lightbulb"></i> About UAP Contact Signals
                    </div>
                    <div class="card-body">
                        <h6>Signal Architecture:</h6>
                        <ul>
                            <li><strong>Foundation Layer:</strong> Base tone (100 Hz) + Schumann resonance (7.83 Hz)
                            </li>
                            <li><strong>Human Enhancement:</strong> Music-modulated DNA repair (528 Hz) + Ambient pad
                                (432 Hz)</li>
                            <li><strong>Attention Layer:</strong> Chirps (2500 Hz) + Ultrasonic pings (17 kHz)</li>
                            <li><strong>Life Indicator:</strong> Filtered breath layer with tremolo</li>
                        </ul>
                        <p class="mb-0">
                            <small class="text-muted">
                                Based on UAP Dog Whistle research. Combines Earth's natural frequencies with human
                                creativity.
                            </small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="loadingModal" class="modal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <div id="progressSpinner" class="spinner-border text-primary mb-3" role="status"
                        style="width: 4rem; height: 4rem; opacity: 0.2;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p id="progressText">Generating UAP contact signal...</p>
                    <div class="progress mt-3" style="height: 25px;">
                        <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated"
                            role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0"
                            aria-valuemax="100">0%</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer mt-5 py-3 bg-dark text-center">
        <div class="container">
            <span class="text-muted">
                UAP Signal Generator v2.0 - Hybrid Multi-Layer |
                Developed by <a href="https://github.com/ddeveloper72" target="_blank" class="text-primary">GitHub</a> |
                <a href="https://x.com/DGFalconer" target="_blank" class="text-primary">@DGFalconer</a> |
                <a href="https://www.linkedin.com/in/duncanfalconer/" target="_blank" class="text-primary">LinkedIn</a>
            </span>
            <br>
            <small class="text-muted">Human-AI Collaborative Research Project | December 2025</small>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>

</html>